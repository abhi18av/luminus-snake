{"version":3,"file":"snake.core.js","sources":["snake/core.cljs"],"mappings":"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","names":["snake.core/state","cljs.core.atom.cljs$core$IFn$_invoke$arity$1","goog.dom/getElement","p__26675","p__26676","vec__26677","cljs.core.nth.cljs$core$IFn$_invoke$arity$3","vec__26680","snake.core/add-coordinates","x1","y1","x2","y2","cljs.test/test-var","the-var__12224__auto__","snake.core/add-coordinates-test","shadow.test.env/register-test","values__11811__auto__","cljs.core/List","result__11812__auto__","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.test/do-report","cljs.core/cons","t__11856__auto__","e26683","cljs.core/=","p__26685","p__26686","vec__26687","vec__26690","snake.core/coordinates-equal?","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","snake.core/coordinates-equal?-test","e26693","p__26695","vec__26696","snake.core/draw","x","y","color","map__26699","cljs.core/PROTOCOL_SENTINEL","cljs.core/hash-map","ctx","cljs.core.get.cljs$core$IFn$_invoke$arity$2","width","height","border","cljs.core/deref","snake.core/draw-test","e26701","e26702","snake.core/resize-canvas","map__26707","element","snake.core/resize-canvas-test","e26709","snake.core/keycode->direction","keycode","cljs.core.get.cljs$core$IFn$_invoke$arity$3","goog/events.KeyCodes.UP","goog/events.KeyCodes.DOWN","goog/events.KeyCodes.LEFT","goog/events.KeyCodes.RIGHT","snake.core/keycode->direction-test","e26711","snake.core/opposite-direction?","dir1","dir2","snake.core/on-keydown","event","map__26713","direction","new-direction","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4","cljs.core/assoc-in","p__26715","vec__26716","snake.core/out-of-boundary?","max-x","max-y","p__26720","vec__26721","snake.core/self-collission?","map__26724","body","p1__26719#","cljs.core/some","p__26726","vec__26727","snake.core/eat-food?","map__26730","food","snake.core/generate-food","map__26732","food-color","cljs.core/rand-int","cljs.core/not","snake.core/game-loop","map__26735","background-color","body-color","speed","head","cljs.core.nth.cljs$core$IFn$_invoke$arity$2","tail","cljs.core/last","js/alert","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$variadic","cljs.core/assoc","cljs.core.conj.cljs$core$IFn$_invoke$arity$2","cljs.core.drop_last.cljs$core$IFn$_invoke$arity$1","js/window.setTimeout","snake.core/init","goog.events/removeAll","js/document","goog.events/listen","goog/events.EventType.KEYDOWN","snake.core/app","snake.core/main","reagent.core.render.cljs$core$IFn$_invoke$arity$2"],"sourcesContent":["(ns snake.core\n  (:require [reagent.core :as r]\n            [goog.dom :as dom]\n            [goog.events.EventType]\n            [goog.events :as events]\n            [goog.events.KeyCodes]\n            [clojure.test :as t]))\n\n\n(def state\n  (atom {;; canvas object\n         :canvas/element  (dom/getElement \"canvas\")\n         :canvas/ctx      (-> (dom/getElement \"canvas\") (.getContext \"2d\"))\n         :canvas/background-color \"white\" ; default canvas color (background)\n         :canvas/width  640\n         :canvas/height 480\n         ;; snake object\n         :snake/body '([0 0] [1 0] [2 0]) ; [x y]\n         :snake/direction [0 1]           ; default direction, see `keycode->direction`\n         :snake/width  32                 ; 640 / 20\n         :snake/height 24                 ; 480 / 20\n         :snake/border 2                  ; border size\n         :snake/body-color \"lime\"         ; snake's body color\n         :snake/alive true                ; when `false`, stop game loop\n         :snake/speed 150                 ; the initial speed of the snake\n         ;; snake food\n         :snake/food nil                  ; when `nil`, regenerate it\n         :snake/food-color \"red\"          ; the color of food\n         :snake/food-count nil            ; the number of food items snake already ate\n         }))\n\n\n\n;; ------------------------------\n;; Helper functions\n\n\n(defn add-coordinates [[x1 y1] [x2 y2]]\n  [(+ x1 x2) (+ y1 y2)])\n\n(t/deftest add-coordinates-test\n  (t/is\n    (= [4 6] (add-coordinates [1 2] [3 4]) )))\n\n\n(defn coordinates-equal? [[x1 y1] [x2 y2]]\n  (and (= x1 x2) (= y1 y2)))\n\n(t/deftest coordinates-equal?-test\n  (t/is\n   (= false (coordinates-equal? [1 2] [3 4]) )))\n\n\n;; -----------------------------\n;; Canvas functions\n\n(defn draw\n  \"Draw the point on canvas according to snake's width/height.\"\n  [[x y] color]\n  (let [{:keys [:canvas/ctx :snake/width :snake/height :snake/border]} (deref state )]\n    (set! (.-fillStyle ctx) color)\n    (.fillRect  ctx\n                (* x width)\n                (* y height)\n                (- width border)\n                (- height border))))\n\n\n;; snake.core.draw([2,1], \"green\")\n(t/deftest draw-test\n (t/is\n  (= [32 24 30 22]\n   (draw [1 1] \"green\")))\n (t/is\n  (= \"green\"\n    (.-fillStyle (:canvas/ctx @state)))))\n\n\n\n\n(defn resize-canvas\n  \"Resize the canvas according to state.\"\n  []\n  (let [{:keys [:canvas/element :canvas/width :canvas/height]} @state]\n    (.setAttribute element \"width\"  width)\n    (.setAttribute element \"height\" height)))\n\n;; snake.core.resize_canvas()\n(t/deftest resize-canvas-test\n (t/is\n  (= 640 (.-width (dom/getElement \"canvas\")))))\n\n\n\n;; ------------------------------\n;; Game functions\n\n(defn keycode->direction\n  \"Convert javascript's keycode to direction array.\"\n  [keycode]\n  (get {goog.events.KeyCodes.UP    [0 -1]  ; code: 38\n        goog.events.KeyCodes.DOWN  [0  1]  ; code: 40\n        goog.events.KeyCodes.LEFT  [-1 0] ; code: 37\n        goog.events.KeyCodes.RIGHT [1 0]} ; code: 39\n       keycode nil))\n\n(t/deftest keycode->direction-test\n  (t/is\n    (= [1 0] (keycode->direction 39))))\n\n\n(defn opposite-direction?\n  \"Detect two direction array are opposite direction or not.\"\n  [dir1 dir2]\n  (= [0 0] (add-coordinates dir1 dir2)))\n\n(defn on-keydown\n  \"The keydown event handler.\"\n  [event]\n  (let [{:keys [:snake/direction]} @state\n        new-direction (keycode->direction (.-keyCode event))]\n    ;; We only handle direction exist condition\n    (when new-direction\n      ;; When two direction are not opposite direction, save new direction\n      (when-not (opposite-direction? new-direction direction)\n        (swap! state assoc-in [:snake/direction] new-direction)))))\n\n(defn out-of-boundary?\n  \"Check if axis is exceed the game board boundary.\"\n  [[x y]]\n  (let [max-x (/ (:canvas/width @state)  (:snake/width @state))\n        max-y (/ (:canvas/height @state) (:snake/height @state))]\n    (or (>= y max-y) (< y 0) (>= x max-x) (< x 0))))\n\n(defn self-collission?\n  \"Check if axis is collision with snake's body.\"\n  [[x y]]\n  (let [{:keys [:snake/body]} @state]\n    (some #(coordinates-equal? [x y] %) body)))\n\n(defn eat-food?\n  \"Check if axis is equal the food's axis.\"\n  [[x y]]\n  (let [{:keys [:snake/food]} @state]\n    (coordinates-equal? [x y] food)))\n\n(defn generate-food\n  \"Generate the food on a random coordinate.\"\n  []\n  (let [{:keys [:snake/body :snake/food :snake/food-color]} @state\n        max-x (/ (:canvas/width @state)  (:snake/width @state))\n        max-y (/ (:canvas/height @state) (:snake/height @state))]\n    ;; skip when current food exist\n    (when (nil? food)\n      ;; generate food axis\n      (loop [food [(rand-int max-x) (rand-int max-y)]]\n        (if-not (self-collission? food)\n          (do\n            (swap! state assoc-in [:snake/food] food)\n            (draw food food-color)\n            food)\n          (recur [(rand-int max-x) (rand-int max-y)]))))))\n\n(defn game-loop\n  \"The main game-loop.\"\n  []\n  (let [{:keys [:canvas/background-color :snake/body :snake/body-color :snake/direction :snake/speed]}  @state\n        head (add-coordinates (nth body 0) direction)\n        tail (last body)]\n\n    ;; Every time we enter the game-loop, check if we need to generate new food or not\n    (generate-food)\n\n    ;; Detect if snake collided with it's own body\n    (when (self-collission? head)\n      (js/alert (str \"Snake is collission with itself at : \" head))\n      ;(js/console.log (str \"Snake is collission with itself at : \" head))\n      (swap! state assoc-in [:snake/alive] false))\n\n    ;; Detect if snake exceeded the boundary\n    (when (out-of-boundary? head)\n      (js/alert (str \"Snake is out of boundary at :\" head))\n      ;(js/console.log (str \"Snake is out of boundary at :\" head))\n      (swap! state assoc-in [:snake/alive] false))\n\n    ;; When snake is alive, draw the snake and switch next game-loop\n    (when (:snake/alive @state)\n      ;; Draw head\n      (draw  head body-color)\n      ;; Detect if food eat by snake or not\n      (if (eat-food? head)\n        ;; When food was eaten by snake, just increase it's head and not remove tail\n        (swap! state assoc\n               :snake/food nil\n               :snake/body (conj body head))\n        (do\n          ;; Remove tail by draw canvas's background-color\n          (draw  tail background-color)\n          ;; Add head and remove tail\n          (swap! state assoc-in [:snake/body] (-> (conj body head) drop-last))))\n\n      ;; next move, you can modify the `150` to change different speed\n      (js/window.setTimeout (fn [] (game-loop)) speed))))\n\n;;;;;;;;;;;;;;;\n;;;;;;;;;;;;;;;\n;;;;;;;;;;;;;;;\n\n(comment\n(defn app\n  []\n;; Resize canvas object\n (resize-canvas)\n; Remove all listen events\n (events/removeAll js/document)\n; Register event listener `on-keydown` event\n (events/listen js/document goog.events.EventType.KEYDOWN on-keydown)\n; Start the game loop\n (game-loop)) )\n\n\n\n(defn init []\n  ;; init is called ONCE when the page loads\n  ;; this is called in the index.html and must be exported\n  ;; so it is available even in :advanced release builds\n ;(js/console.log \"init\")\n ;; Resize canvas object\n (resize-canvas)\n  ;; Remove all listen events\n (events/removeAll js/document)\n  ;; Register event listener `on-keydown` event\n (events/listen js/document goog.events.EventType.KEYDOWN on-keydown)\n  ;; Start the game loop\n (game-loop))\n\n(defn app\n  []\n  [:div\n        [\n         :canvas/element  (dom/getElement \"canvas\")\n         :canvas/ctx      (-> (dom/getElement \"canvas\") (.getContext \"2d\"))\n         :canvas/background-color \"white\" ; default canvas color (background)\n         :canvas/width  640\n         :canvas/height 480 ]])\n\n(defn ^:export main\n  []\n  (r/render\n    [app]\n    (.getElementById js/document \"app\")))\n\n;;;;;;;;;;;;;;;\n;;;;;;;;;;;;;;;\n;;;;;;;;;;;;;;;\n\n\n;; NOTE run all tests on browser\n\n\n;(t/run-tests)\n"]}