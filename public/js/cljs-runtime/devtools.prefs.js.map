{"version":3,"file":"devtools.prefs.js","sources":["devtools/prefs.cljs"],"mappings":";;;AAKA,AAAKiC,gCAAe,KAAAhC,gBAAA;AAAA,AAAA,OAAA+B,gBAAQE;GAAR;AACpB,AAAKN,iCAAgB,KAAA3B,gBAAA;AAAA,AAAO;GAAP;AACrB,AAAKD,4BAAW,KAAAC,gBAAA;AAAA,AAAO;GAAP;AAChB,AAAKmC,gCAAe,KAAAnC,gBAAA;AAAA,AAAO,8GAAA,AAAA+B,+CAAA,AAAAA,gDAAA,AAAAA,tMAACP,uHAAOQ,+CAAgBL,gDAAiB5B;GAAhD;AAEpB,AAAeE,4CAAiB,KAAAD,gBAAA;AAAA,AAAA,OAAA+B,gBAAQI;GAAR;AAIhC,iCAAA,jCAAMZ,0EAAYrB;AAChB,OAAMD,4CAAiBC,nDADzB;;AAGA,2BAAA,3BAAMuB;AAAN,AACE,GAAM,AAACW,uBAAOnC;AACZ,+BAAA,AAAA8B,/BAACR,+CAAYtB,/CADf;;AAAA;;AAEAA;;AAEF,sBAAA,tBAAMmB,oDAAMJ;AAAZ,AACE,IAAAc,WAAK,AAACL;AAAN,AAAA,8EAAAK,0BAAAA,hGAACd,oCAAAA,8CAAAA;;AAEH,gCAAA,hCAAMM,wEAAWN,IAAIa;AAArB,AACE,OAACN,+BAAW,AAACW,8CAAM,AAACT,2BAAWT,IAAIa;;AAErC,mCAAA,nCAAMD,8EAAcF;AAClB,OAACH,+BAAW,AAACC,uGAAM,AAACC,2BAAWC,xKADjC;;AAGA,AAAA,mCAAA,2CAAAvB,9EAAMM;AAAN,AAAA,IAAAL,qBAAA;AAAA,AAAA,IAAAC,0BAAA,AAAA;AAAA,AAAA,IAAAC,wBAAA;;AAAA,AAAA,GAAA,CAAAA,wBAAAD;AAAA,AAAA,AAAAD,wBAAA,CAAA,UAAAE;;AAAA,eAAA,CAAAA,wBAAA;;;;AAAA;;;;AAAA,IAAAC,uBAAA,EAAA,CAAA,MAAA,AAAAH,4BAAA,AAAA,KAAAI,qBAAA,AAAAJ,yBAAA,KAAA,IAAA,OAAA;AAAA,AAAA,OAAAK,sEAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAAF;;;AAAA,AAAA,AAAA,AAAAE,wEAAA,WAAoBO,IAAIC,EAAIC;AAA5B,kFAC+BF,KAAKE,zBAAX,hDAARC,dAAf,4DAAqBF,EAAGG,hDAAV,VAARC;AAAN,AACE,OAACC,8BAAUN,IAAIK;;;AAFnB,AAAA,AAAAZ,2DAAA;;AAAA;AAAA,AAAA,AAAAA,qDAAA,WAAAC;AAAA,AAAA,IAAAC,WAAA,AAAAC,gBAAAF;IAAAA,eAAA,AAAAG,eAAAH;IAAAI,WAAA,AAAAF,gBAAAF;IAAAA,eAAA,AAAAG,eAAAH;AAAA,AAAA,IAAAK,qBAAA;AAAA,AAAA,OAAAA,wDAAAJ,SAAAG,SAAAJ;;;AAAA","names":["devtools.prefs/env-config","cljs.core/Delay","devtools.prefs/*current-config*","new-prefs","var_args","args__4502__auto__","len__4499__auto__","i__4500__auto__","argseq__4503__auto__","cljs.core/IndexedSeq","devtools.prefs/update-pref!","seq27615","G__27616","cljs.core/first","cljs.core/next","G__27617","self__4486__auto__","key","f","args","cljs.core.apply.cljs$core$IFn$_invoke$arity$3","devtools.prefs/pref","new-val","devtools.prefs/set-pref!","devtools.prefs/set-prefs!","cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic","devtools.prefs/get-prefs","m","devtools.prefs/external-config","devtools.prefs/merge-prefs!","val","G__27607","cljs.core/deref","devtools.prefs/default-config","devtools.defaults/config","cljs.core.assoc.cljs$core$IFn$_invoke$arity$3","devtools.prefs/initial-config","cljs.core/delay?"],"sourcesContent":["(ns devtools.prefs\n  (:require-macros [devtools.prefs :refer [emit-external-config emit-env-config]])\n  (:require [devtools.defaults :as defaults]))\n\n; we use delay for DCE, see https://github.com/binaryage/cljs-devtools/issues/37\n(def default-config (delay @defaults/config))\n(def external-config (delay (emit-external-config)))\n(def env-config (delay (emit-env-config)))\n(def initial-config (delay (merge @default-config @external-config @env-config)))\n\n(def ^:dynamic *current-config* (delay @initial-config))\n\n; -- public api -------------------------------------------------------------------------------------------------------------\n\n(defn set-prefs! [new-prefs]\n  (set! *current-config* new-prefs))\n\n(defn get-prefs []\n  (when (delay? *current-config*)\n    (set-prefs! @*current-config*))\n  *current-config*)\n\n(defn pref [key]\n  (key (get-prefs)))\n\n(defn set-pref! [key val]\n  (set-prefs! (assoc (get-prefs) key val)))\n\n(defn merge-prefs! [m]\n  (set-prefs! (merge (get-prefs) m)))\n\n(defn update-pref! [key f & args]\n  (let [new-val (apply f (pref key) args)]\n    (set-pref! key new-val)))\n"]}